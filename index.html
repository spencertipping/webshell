<html>
  <head>
    <title>HTML Editor</title>

    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>

    <script>
      var timeout = null;
      var last    = '';
      var update  = function () {
        if (last !== $('#source').val()) {
          timeout && clearTimeout (timeout);
          timeout = setTimeout (function () {
            var rendered = escape ($('#source').val());
            $('#rendered').attr('src',  'data:text/html,'  + rendered);
            $('#download').attr('href', 'data:text/plain,' + rendered);
          }, 200);
          last = $('#source').val();
        }
      };

      $(function () {
        document.location.hash && $.get (document.location.hash.substr(1), function (x) {
          $('#source').val(x);
          update();
        });
      });
    </script>

    <style>
      body {font-family: sans-serif}
    </style>
  </head>

  <body>
    <div><a id='download' target='_blank'>Download HTML file</a></div>
    <textarea style='width: 400px; height: 100%; background: #eee; border: solid 1px #ccc' id='source' onkeyup='update()'></textarea>
    <iframe style='position: absolute; left: 420px; height: 100%; border: solid 1px #ccc' id='rendered'></iframe>
  </body>
</html>
